select z.eno||','||case when instr(z.surveyid, ',')>0 then '"' || z.surveyid || '"' else z.surveyid end||','||case when instr(z.surveyname, ',')>0 then '"' || z.surveyname || '"' else z.surveyname end||','||s.sampleid||','||s.sampleno||','||s.sample_type||','||to_char(s.acquiredate, 'YYYY-MM-DD')||','||s.top_depth||','||s.base_depth||','||case when instr(s.comments, ',')>0 then '"' || s.comments || '"' else s.comments end||','||case when s.min_longitude is null then null else to_char(s.min_longitude) || ' / ' || to_char(s.min_latitude) end||','||case when s.max_longitude is null then null else to_char(s.max_longitude) || ' / ' || to_char(s.max_latitude) end||','||(s.min_waterdepth+nvl(s.max_waterdepth,s.min_waterdepth))/2||','|| sd.datano||','||sd.property||','||case when instr(sd.qualifier, ',')>0 then '"' || sd.qualifier || '"' else sd.qualifier end||','||sd.seq_no||','||sd.qual_value||','||sd.quant_value||','||sd.uom||','||sd.method||','||sd.confidence||','||to_char(sd.analysisdate, 'YYYY-MM-DD')||','||sd.obs_type||','||sd.batchno||','||case when instr(sd.comments, ',')>0 then '"' || sd.comments || '"' else sd.comments end from npm.web_mars_surveys z join npm.web_mars_samples s on s.eno = z.eno and s.ext_int = 'EXT'  and (1=1 or :C is null)  and sdo_anyinteract(s.geom, :G) = 'TRUE'    join npm.web_mars_sampledata sd on sd.sampleno = s.sampleno and sd.property = 'grain size' and sd.ext_int = 'EXT'  where z.ext_int = 'EXT'  and (1=1 or :F is null)  and (1=1 or :T is null)   order by z.surveyname, s.sampleid, s.sampleno, sd.method, sd.datano

SURVEY ENO,SURVEY ID,SURVEY NAME,SAMPLE ID,SAMPLE NO,SAMPLE TYPE,ACQUIRE DATE,TOP DEPTH,BASE DEPTH,SAMPLE COMMENTS,START POINT,END POINT,WATER DEPTH,DATANO,PROPERTY,QUALIFIER,SEQ_NO,TEXT VALUE,NUM VALUE,UOM,METHOD,CONFIDENCE,ANALYSIS DATE,OBSERVATION TYPE,BATCHNO,COMMENTS
40996,SO15,SONNE 15,62/588GS17/0_85,1406056,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992782,grain size,geometric mean (sand fraction),1,,.3253,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/0_85,1406056,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992912,grain size,geometric sorting (sand fraction),1,,.6417,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/0_85,1406056,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993042,grain size,geometric skewness (sand fraction),1,,.7371,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/0_85,1406056,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993172,grain size,geometric kurtosis (sand fraction),1,,.7371,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/200_400,1406057,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992784,grain size,geometric mean (sand fraction),1,,.2073,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/200_400,1406057,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992914,grain size,geometric sorting (sand fraction),1,,.7684,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/200_400,1406057,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993044,grain size,geometric skewness (sand fraction),1,,5.4642,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/200_400,1406057,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993174,grain size,geometric kurtosis (sand fraction),1,,0,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/400_600,1406058,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992785,grain size,geometric mean (sand fraction),1,,.1934,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/400_600,1406058,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992915,grain size,geometric sorting (sand fraction),1,,.7631,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/400_600,1406058,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993045,grain size,geometric skewness (sand fraction),1,,3.8906,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/400_600,1406058,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993175,grain size,geometric kurtosis (sand fraction),1,,0,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/600_800,1406059,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992786,grain size,geometric mean (sand fraction),1,,.1908,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/600_800,1406059,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992916,grain size,geometric sorting (sand fraction),1,,.7684,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/600_800,1406059,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993046,grain size,geometric skewness (sand fraction),1,,2.6945,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/600_800,1406059,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993176,grain size,geometric kurtosis (sand fraction),1,,.0001,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/800_950,1406060,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992787,grain size,geometric mean (sand fraction),1,,.1805,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/800_950,1406060,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992917,grain size,geometric sorting (sand fraction),1,,.8011,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/800_950,1406060,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993047,grain size,geometric skewness (sand fraction),1,,.8179,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/800_950,1406060,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993177,grain size,geometric kurtosis (sand fraction),1,,.0056,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/85_200,1406061,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992783,grain size,geometric mean (sand fraction),1,,.2269,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/85_200,1406061,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4992913,grain size,geometric sorting (sand fraction),1,,.7423,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/85_200,1406061,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993043,grain size,geometric skewness (sand fraction),1,,1.6133,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
40996,SO15,SONNE 15,62/588GS17/85_200,1406061,core,,,,Datum for cordinates is unknown but has been originally recored here as WGS84.,153.5597667 / -27.48405,,-23,4993173,grain size,geometric kurtosis (sand fraction),1,,.048,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (Lindholm. R. 1987.A practical approach to sedimentology. Allen & Unwin.)
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968895,grain size,2mm - 64mm,1,,0,%,Sieve,,,unknown,unknown,Gravel.
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968896,grain size,62.5um - 2000um,1,,100,%,Sieve,,,unknown,unknown,Sand.
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968899,grain size,<62.5um,1,,0,%,Sieve,,,unknown,unknown,Mud.
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968897,grain size,3.9um - 62.5um,1,,0,%,pipette,,,unknown,unknown,Silt.
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968898,grain size,<3.9um,1,,0,%,pipette,,,unknown,unknown,Clay.
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968900,grain size,geometric mean (bulk),1,,.3392,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (R. Lindholm. 1987.A practical approach to sedimentology. Allen & Unwin.)
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,4968901,grain size,geometric sorting (bulk),1,,.722,mm,,,,unknown,unknown,Originally calculated using methods of moments in phi. Converted from phi to mm using mm=2-phi. (R. Lindholm. 1987.A practical approach to sedimentology. Allen & Unwin.)
41327,GA-144,Southern Barrier Reef and Northern Tasman Sea,144/DR1460,1409937,seabed sample,1970-11-04,,,Error less than 1mile (1.609km). Fixed by direct reference to charted position,153.5833333 / -27.5,,-31,15231764,grain size,Folk texture,1,S,,,,,,,,Sand

